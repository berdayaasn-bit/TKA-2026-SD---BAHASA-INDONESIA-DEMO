<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo TKA SD Kelas 6 - Belajar Sukses</title>
    <style>
        :root {
            --primary: #4F46E5;
            --primary-hover: #4338CA;
            --secondary: #F59E0B;
            --bg-color: #F3F4F6;
            --card-bg: #FFFFFF;
            --text-main: #1F2937;
            --text-muted: #6B7280;
            --danger: #EF4444;
            --success: #10B981;
            --gold: #FFD700;
        }

        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: none;
            flex-direction: column;
            min-height: 90vh;
        }

        .active-page {
            display: flex;
        }

        /* Header & Timer */
        .header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timer-locked {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: not-allowed;
        }

        /* Login Page */
        #login-page {
            justify-content: center;
            align-items: center;
            padding: 40px;
            text-align: center;
        }

        .input-group {
            position: relative;
            margin: 20px 0;
            width: 100%;
            max-width: 300px;
        }

        .input-group input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
        }

        .input-group input:focus {
            border-color: var(--primary);
        }

        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--text-muted);
        }

        button.btn-main {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            width: 100%;
            max-width: 300px;
        }

        button.btn-main:hover {
            background: var(--primary-hover);
        }

        /* Quiz Area */
        .quiz-content {
            padding: 25px;
            flex-grow: 1;
            overflow-y: auto;
        }

        .wacana-box {
            background: #FEF3C7;
            padding: 15px;
            border-left: 4px solid var(--secondary);
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 0.95em;
            line-height: 1.6;
            display: none;
        }

        .question-text {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .question-text img {
            max-width: 100%;
            border-radius: 8px;
            margin: 10px 0;
            display: block;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
        }

        .option-label:hover {
            background: #F9FAFB;
            border-color: #D1D5DB;
        }

        .option-label input {
            margin-right: 15px;
            transform: scale(1.2);
        }

        .option-label.selected {
            border-color: var(--primary);
            background: #EEF2FF;
        }

        /* Footer Nav & Grid */
        .quiz-footer {
            padding: 15px 25px;
            border-top: 1px solid #E5E7EB;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            background: #E5E7EB;
            font-weight: bold;
            cursor: pointer;
        }

        .nav-btn.next {
            background: var(--primary);
            color: white;
        }

        .cbt-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            padding: 15px;
            background: #F9FAFB;
            border-top: 1px solid #E5E7EB;
            opacity: 0.6;
            cursor: not-allowed;
            position: relative;
        }

        .grid-item {
            padding: 10px;
            text-align: center;
            background: white;
            border: 1px solid #D1D5DB;
            border-radius: 6px;
            font-weight: bold;
            pointer-events: none;
        }

        .grid-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        .grid-overlay-btn {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            cursor: pointer;
        }

        /* Result Page & Paywall */
        #result-page {
            padding: 30px 20px;
            text-align: center;
            overflow-y: auto;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            font-weight: bold;
            margin: 0 auto 20px;
            border: 5px solid #C7D2FE;
        }

        .premium-banner {
            background: linear-gradient(135deg, #FFD700, #F59E0B);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            color: #78350F;
            border: 2px solid #D97706;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .premium-banner h3 {
            margin-bottom: 10px;
            font-size: 1.4em;
            color: #92400E;
        }

        .btn-upgrade {
            display: inline-block;
            background: #DC2626;
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: bold;
            text-decoration: none;
            margin-top: 15px;
            animation: blinker 1.5s linear infinite;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.5);
            border: 2px solid white;
        }

        @keyframes blinker {
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .btn-certificate {
            background: #4B5563;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 30px;
        }

        /* Affiliate Section */
        .affiliate-section {
            text-align: left;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #D1D5DB;
        }

        .affiliate-section h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
            color: var(--text-main);
        }

        .book-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        @media(min-width: 600px) {
            .book-grid { grid-template-columns: 1fr 1fr; }
        }

        .book-card {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }

        .book-card h4 {
            color: var(--primary);
            margin-bottom: 8px;
        }

        .book-card p {
            font-size: 0.9em;
            color: var(--text-muted);
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .btn-buy {
            display: block;
            text-align: center;
            background: #10B981;
            color: white;
            text-decoration: none;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn-buy:hover { background: #059669; }

        .copyright-raksasa {
            margin-top: 40px;
            font-size: 1.5em;
            font-weight: 900;
            color: #374151;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 20px;
            background: #E5E7EB;
            border-radius: 8px;
        }

        /* SVG Icons */
        .icon { width: 20px; height: 20px; fill: currentColor; }
    </style>
</head>
<body>

<div id="login-page" class="container active-page">
    <h1 style="color: var(--primary); margin-bottom: 10px;" id="display-judul-login"></h1>
    <p style="color: var(--text-muted); margin-bottom: 20px;">Versi Trial / Demo</p>
    
    <div class="input-group">
        <input type="password" id="pin-input" placeholder="Masukkan PIN Akses">
        <div class="toggle-password" onclick="togglePassword()">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
        </div>
    </div>
    <button class="btn-main" onclick="startQuiz()">MULAI KUIS</button>
</div>

<div id="quiz-page" class="container">
    <div class="header">
        <h3 id="display-judul-quiz" style="font-size: 1.1em;"></h3>
        <div class="timer-locked" onclick="alertPremium('Timer')">
            ‚è≥ Waktu: Terkunci (Premium)
        </div>
    </div>
    
    <div class="quiz-content">
        <div id="wacana-container" class="wacana-box"></div>
        <div id="question-text" class="question-text"></div>
        <div id="options-container" class="options-container"></div>
    </div>

    <div class="quiz-footer">
        <button class="nav-btn" id="btn-prev" onclick="navQuestion(-1)">Sebelumnya</button>
        <span id="question-counter" style="font-weight: bold; color: var(--text-muted);">1 / 15</span>
        <button class="nav-btn next" id="btn-next" onclick="navQuestion(1)">Selanjutnya</button>
    </div>

    <div class="cbt-grid-wrapper" style="position: relative;">
        <div class="grid-overlay" onclick="alertPremium('Lompat Soal / Navigasi Pintar')">
            <div class="grid-overlay-btn">üîí Fitur Premium</div>
        </div>
        <div id="cbt-grid" class="cbt-grid"></div>
    </div>
</div>

<div id="result-page" class="container">
    <h2 style="margin-bottom: 20px; color: var(--text-main);">Hasil Ujian Trial</h2>
    <div class="score-circle" id="final-score">0</div>
    
    <button class="btn-certificate" onclick="alertPremium('Cetak Sertifikat')">
        üñ®Ô∏è Cetak Sertifikat üîí
    </button>

    <div class="premium-banner">
        <h3>Hebat! Kamu telah menyelesaikan versi Trial.</h3>
        <p>Ingin akses ke <b>RATUSAN</b> soal berkualitas TKA, fitur Timer, Navigasi Pintar, Pembahasan Lengkap, dan Cetak Sertifikat? Buka potensi belajarmu sekarang!</p>
        <a href="#" id="link-premium" class="btn-upgrade" target="_blank">üöÄ UPGRADE KE PREMIUM SEKARANG</a>
    </div>

    <div class="affiliate-section">
        <h3>üìö Rekomendasi Buku Belajar Pilihan</h3>
        <div class="book-grid">
            <div class="book-card">
                <h4 id="buku1-judul"></h4>
                <p id="buku1-desc"></p>
                <a href="#" id="buku1-link" class="btn-buy" target="_blank">üõí Beli Buku Ini</a>
            </div>
            <div class="book-card">
                <h4 id="buku2-judul"></h4>
                <p id="buku2-desc"></p>
                <a href="#" id="buku2-link" class="btn-buy" target="_blank">üõí Beli Buku Ini</a>
            </div>
        </div>
    </div>

    <div class="copyright-raksasa">
        ¬© 2026 Copyright "Belajar Sukses". All Rights Reserved.
    </div>
</div>

<script>
    // ==========================================
    // 1. KONFIGURASI DATA (FLEKSIBEL)
    // ==========================================
    const JUDUL_KUIS = "DEMO TKA SD KELAS 6";
    const PIN_AKSES = "COBA123";
    const TARGET_TOTAL_SOAL = 15;

    // Link Jualan Produk Digital
    const LINK_PEMBELIAN_PREMIUM = "https://lynk.id/belajarsukses";

    // Data Affiliate Buku Fisik
    const BUKU_1_JUDUL = "Buku Super Drilling TKA SD/MI";
    const BUKU_1_DESC = "Kumpulan soal terlengkap dengan pembahasan jitu untuk persiapan ujian.";
    const BUKU_1_LINK = "https://shope.ee/contohlink_buku1";

    const BUKU_2_JUDUL = "Buku Taktik Cerdik Lulus TKA";
    const BUKU_2_DESC = "Berisi ringkasan materi dan life hack cara cepat menjawab soal.";
    const BUKU_2_LINK = "https://shope.ee/contohlink_buku2";

    // Data Soal Mentah
    const RAW_SINGLE = `
[Tipe: PG] Di sebuah ekosistem laut yang asri, terdapat terumbu karang yang menjadi rumah bagi berbagai **biota**. Apa makna istilah biologi yang dicetak tebal tersebut? | Sekumpulan tumbuhan laut ~ Seluruh flora dan fauna di wilayah tertentu ~ Jenis ikan hias yang langka ~ Batuan yang ada di dasar laut | B | Biota merujuk pada keseluruhan kehidupan (flora dan fauna) di suatu wilayah. 
[Tipe: PG] Perjalanan dari Jakarta ke Bandung kini lebih cepat berkat adanya kereta cepat. Transportasi **modern** ini sangat diminati masyarakat. Sinonim kata "*modern*" pada kalimat tersebut adalah... | Canggih ~ Lawas ~ Tradisional ~ Terkenal | A | Modern dalam konteks transportasi merujuk pada teknologi yang canggih atau terbaru. 
[Tipe: PG] Pak Budi adalah **tangan kanan** direktur di perusahaan itu. Makna ungkapan "**tangan kanan**" adalah... | Orang yang kuat ~ Orang kepercayaan ~ Anggota keluarga ~ Orang yang rajin | B | Tangan kanan adalah idiom untuk orang yang sangat dipercaya oleh atasan. 
[Tipe: PG] Teks cerita misteri: "Keesokan paginya, kotak kayu rahasia di atas meja kakek ternyata telah terbuka gemboknya. Namun, isinya bukanlah tumpukan koin emas seperti yang kuduga selama ini, melainkan secarik peta tua kumal dengan tanda silang merah berdarah di ujungnya." Kalimat manakah yang paling memancing rasa penasaran pembaca dari kutipan tersebut? | Keesokan paginya, kotak kayu rahasia di atas meja kakek telah terbuka ~ Kotak kayu misterius itu berada di atas meja ~ Isinya bukanlah tumpukan koin emas seperti yang kuduga ~ Terdapat secarik peta tua kumal dengan tanda silang merah berdarah di ujungnya | D | Peta yang memiliki tanda spesifik (silang merah) memberikan petunjuk adanya teka-teki baru, membuat pembaca bertanya-tanya arah petualangan selanjutnya.
[Tipe: PG] Dialog Perpisahan Kelas: Siti: "Jaga dirimu baik-baik di SMP seberang pulau sana, Lani. Jangan lupa kirimi aku pesan setiap minggu, ya." Lani: "(Menggenggam tangan Siti) Tentu saja, Siti. Kamu adalah tempat terbaikku berbagi rahasia selama 6 tahun ini. Aku pasti akan sangat merindukanmu." Kesimpulan kedalaman hubungan antartokoh berdasarkan dialog tersebut adalah... | Mereka hanyalah teman sekelas biasa yang kebetulan duduk sebangku ~ Mereka memiliki ikatan persahabatan sejati yang sangat kuat dan emosional ~ Mereka adalah saudara kandung yang akan dipisahkan ~ Mereka baru saja saling mengenal saat kelulusan | B | Dialog "tempat terbaikku berbagi rahasia" dan gestur genggaman tangan mencerminkan tingkat kepercayaan dan persahabatan yang sangat dalam.
[Tipe: PG] Sebuah cerita inspiratif menceritakan perjuangan tokoh penemu, Thomas Alva Edison, yang dikabarkan gagal ribuan kali sebelum akhirnya berhasil menemukan bola lampu yang menyala. Kutipan pernyataan manakah dari tokoh tersebut yang paling memotivasi semangat pantang menyerah pelajar? | "Lampu adalah penemuan yang sangat mahal pembuatannya pada zamanku." ~ "Saya sebenarnya tidak gagal, saya hanya menemukan 10.000 cara yang ternyata tidak berhasil." ~ "Saya selalu bekerja keras di sebuah laboratorium kecil yang sangat gelap setiap malam." ~ "Dibutuhkan banyak sekali bahan baku kaca untuk membuat bola lampu buatan saya." | B | Membingkai kegagalan sebagai "cara yang tidak berhasil" adalah pola pikir (mindset) positif yang luar biasa memotivasi pembaca untuk tidak menyerah.
[Tipe: PG] Di dalam ekosistem laut yang sehat terdapat beragam biota laut yang hidup saling bergantungan. Makna istilah biologi yang dicetak tebal pada kalimat tersebut adalah... | Seluruh flora dan fauna di suatu wilayah ~ Kumpulan tumbuhan laut yang hidup di dasar karang ~ Jenis ikan pemakan plankton yang ukurannya kecil ~ Bebatuan karang tempat ikan bersembunyi | A | Biota adalah keseluruhan kehidupan flora dan fauna yang terdapat di dalam suatu daerah atau ekosistem tertentu.
[Tipe: PG] Cuaca di padang rumput itu sangat terik pada siang hari sehingga tanahnya menjadi kering. Antonim dari kata sifat yang mendeskripsikan kondisi alam tersebut adalah... | Panas ~ Teduh ~ Cerah ~ Gersang | B | Antonim atau lawan kata dari terik (sangat panas) adalah teduh.
[Tipe: PG] Keindahan pemandangan Pantai Kuta di sore hari sungguh *menawan hati* setiap turis asing yang datang. Makna konotatif positif dari frasa bercetak miring tersebut adalah... | Sangat indah dan menarik perhatian ~ Sangat luas dan cukup berbahaya ~ Sangat sepi dan menenangkan ~ Sangat ramai dan penuh sesak | A | Frasa 'menawan hati' memiliki konotasi positif yang berarti sangat menarik, memikat, atau indah dipandang.
[Tipe: PG] Susunlah kata-kata acak berikut menjadi kalimat efektif yang benar: (1) membeli (2) apotek (3) ibu (4) di (5) obat. | 3-1-5-4-2 ~ 3-1-4-5-2 ~ 5-1-3-4-2 ~ 3-5-1-4-2 | A | Susunan kalimat efektif berpedoman pada pola Subjek-Predikat-Objek-Keterangan (S-P-O-K) yaitu "Ibu (3) membeli (1) obat (5) di (4) apotek (2)".
[Tipe: PG] "Kemarin sore aku antri cukup lama saat membeli tiket di stasiun," kata paman. Penggunaan kata tidak baku dalam kalimat dialog tersebut jika diperbaiki menjadi kata baku adalah... | Antre ~ Mengantri ~ Antrian ~ Ngantri | A | Kata baku yang benar sesuai Pedoman Umum Ejaan Bahasa Indonesia (PUEBI) adalah "antre".
[Tipe: PGK] Manakah kelompok kata di bawah ini yang seluruhnya termasuk dalam kosakata bidang olahraga sepak bola? | Gawang ~ Penalti ~ Kok ~ Servis | A, B | Gawang dan penalti adalah istilah dalam sepak bola. Kok dan servis adalah istilah dalam bulu tangkis/tenis.
[Tipe: PG] Bacalah penggalan puisi anak berikut: "Di pagi hari yang cerah aku melihat seekor kupu-kupu hinggap di atas **bunga** yang sedang mekar." Makna denotatif dari kata yang dicetak tebal adalah... | Gadis desa yang sangat cantik rupawan ~ Bagian tumbuhan yang akan menjadi buah ~ Seseorang pahlawan yang menjadi idola ~ Hasil dari tabungan yang disimpan di bank | B | Makna denotatif adalah makna yang sebenarnya. Bunga dalam konteks alam merujuk pada bagian tumbuhan.
[Tipe: PG] Aku adalah salah satu benda langit yang bercahaya. Aku memancarkan cahayaku sendiri yang sangat panas dan aku menjadi pusat tata surya. Benda langit apakah aku? | Bumi ~ Bulan ~ Bintang ~ Matahari | D | Matahari adalah bintang yang menjadi pusat tata surya dan memancarkan cahayanya sendiri.
[Tipe: PG] Tanaman obat tradisional ini memiliki rimpang dengan bagian dalam berwarna kuning jingga. Masyarakat biasa memarut dan memeras airnya untuk dibuat jamu penambah nafsu makan atau meredakan nyeri perut. Nama tanaman obat tersebut adalah... | Jahe ~ Kencur ~ Kunyit ~ Lengkuas | C | Kunyit memiliki ciri khas warna rimpang kuning jingga dan biasa dipakai sebagai jamu tradisional.
[Tipe: PG] Permainan tradisional anak-anak ini dilakukan dengan melompat menggunakan satu kaki pada kotak-kotak yang digambar di atas tanah. Sebelum melompat pemain harus melempar batu pipih atau gacuk ke dalam kotak. Nama permainan tradisional tersebut adalah... | Engklek ~ Gobak Sodor ~ Congklak ~ Petak Umpet | A | Ciri khas permainan engklek adalah melompat dengan satu kaki pada pola kotak di tanah menggunakan gacuk.
    `;

    const RAW_CLUSTER = `
###
[WACANA: Rahasia Kesehatan di Musim Pancaroba] Kondisi cuaca yang tidak menentu belakangan ini membuat tubuh rentan terserang penyakit. Perubahan suhu dari **panas** ke dingin yang tiba-tiba sering kali memicu gangguan kesehatan. Untuk menjaga imunitas, dokter menyarankan konsumsi vitamin secara rutin. Jika muncul gejala (1)... seperti demam atau batuk, sebaiknya segera periksa ke (2)... terdekat. Selain itu, menjaga kebersihan diri dengan rajin mencuci tangan sangatlah penting. Langkah mencuci tangan dimulai dengan membasahi tangan, memakai sabun, menggosok telapak serta punggung tangan, membersihkan sela jari, lalu membilasnya dengan air mengalir hingga bersih.
[Tipe: PG] Apa antonim dari kata "**panas**" yang mendeskripsikan kondisi alam pada teks tersebut? | Hangat ~ Sejuk ~ Dingin ~ Terik | C | Antonim atau lawan kata panas dalam konteks suhu adalah dingin. 
[Tipe: PG] Isilah rumpang (1) dan (2) pada teks dengan istilah medis yang tepat! | (1) Gejala - (2) Apotek ~ (1) Diagnosis - (2) Laboratorium ~ (1) Klinis - (2) Puskesmas ~ (1) Pasien - (2) Apotek | C | Istilah medis sederhana yang tepat untuk melengkapi teks adalah klinis (terkait gejala) dan puskesmas (tempat periksa). 
[Tipe: PGK] Manakah langkah-langkah mencuci tangan yang benar sesuai teks? | Membasahi tangan dan memakai sabun ~ Menggosok punggung tangan ~ Membersihkan sela-sela jari ~ Mengeringkan dengan baju | A, B, C | Berdasarkan teks, langkahnya adalah membasahi, sabun, gosok punggung, dan sela jari.
###
###
[WACANA: Keajaiban Metamorfosis Katak] Katak merupakan hewan amfibi yang mengalami siklus hidup unik. Proses ini diawali dari telur yang diletakkan induknya di dalam air. Setelah beberapa hari, telur menetas menjadi kecebong atau berudu yang bernapas dengan insang. Seiring berjalannya waktu, pada kecebong tumbuh kaki belakang, disusul kaki depan, dan ekornya mulai memendek hingga terbentuklah katak muda. Akhirnya, katak muda tumbuh menjadi katak dewasa yang bernapas menggunakan paru-paru dan kulit. Pengamatan ini dicatat dalam tabel pertumbuhan untuk melihat perubahan panjang tubuhnya setiap minggu.
[Tipe: BS] Tentukan benar atau salah pernyataan mengenai siklus hidup katak berdasarkan teks: | Kecebong bernapas menggunakan paru-paru (Salah) ~ Kaki depan tumbuh lebih dulu daripada kaki belakang (Salah) ~ Katak dewasa bernapas dengan paru-paru dan kulit (Benar) | - | Kecebong menggunakan insang, kaki belakang tumbuh lebih dulu, dan dewasa menggunakan paru-paru/kulit. 
[Tipe: PG] [IMG: https://i.ibb.co.com/Psz3GG0n/Gemini-Generated-Image-9b5iel9b5iel9b5i.png] Bagian diagram yang kosong setelah fase "Telur" dan sebelum "Katak Muda" seharusnya diisi dengan... | Katak Dewasa ~ Kecebong ~ Telur Ikan ~ Kepompong | B | Setelah telur menetas, fase berikutnya dalam metamorfosis katak adalah kecebong/berudu. 
[Tipe: PGK] Informasi apa saja yang dapat dimasukkan ke dalam tabel data hasil laporan pengamatan teks di atas? | Nama pengamat ~ Panjang tubuh katak setiap minggu ~ Tahapan perkembangan yang terjadi ~ Harga pakan katak | B, C | Teks menyebutkan pencatatan perubahan panjang tubuh dan tahapan pertumbuhan.
###
    `;

    // ==========================================
    // 2. ENGINE DASAR & PARSER
    // ==========================================
    let questionsData = [];
    let currentIndex = 0;
    let userAnswers = {};

    function parseMarkdown(text) {
        // Auto-Cleaner: Hapus nomor bawaan teks soal ("1. ", "2. ")
        text = text.replace(/^\d+\.\s*/, '');
        // Markdown Renderer: Bold, Italic, Enter, IMG
        return text
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/<br>/g, '<br>')
            .replace(/\[IMG:\s*(.*?)\]/g, '<img src="$1" alt="Gambar Soal">');
    }

    function extractQuestions(rawSingle, rawCluster) {
        let tempQuestions = [];

        // Parse Single
        const singleMatches = rawSingle.match(/\[Tipe:\s*([A-Z]+)\](.*?)\|(.*?)\|(.*?)\|/g);
        if(singleMatches) {
            singleMatches.forEach(match => {
                const parts = match.split('|');
                const typeStr = parts[0].match(/\[Tipe:\s*([A-Z]+)\]/)[1];
                const questionText = parts[0].replace(/\[Tipe:\s*[A-Z]+\]/, '').trim();
                const options = parts[1].trim();
                const answer = parts[2].trim();
                
                tempQuestions.push({
                    type: typeStr,
                    wacana: null,
                    text: parseMarkdown(questionText),
                    options: options.split('~').map(o => parseMarkdown(o.trim())),
                    correctKey: answer
                });
            });
        }

        // Parse Cluster
        const clusters = rawCluster.split('###').filter(c => c.trim() !== '');
        clusters.forEach(cluster => {
            const wacanaMatch = cluster.match(/\[WACANA:(.*?)\](.*?)(\[Tipe:|$)/s);
            let wacanaHTML = null;
            if(wacanaMatch) {
                wacanaHTML = `<strong>${wacanaMatch[1].trim()}</strong><br>${parseMarkdown(wacanaMatch[2].trim())}`;
            }

            const clusterMatches = cluster.match(/\[Tipe:\s*([A-Z]+)\](.*?)\|(.*?)\|(.*?)\|/g);
            if(clusterMatches) {
                clusterMatches.forEach(match => {
                    const parts = match.split('|');
                    const typeStr = parts[0].match(/\[Tipe:\s*([A-Z]+)\]/)[1];
                    const questionText = parts[0].replace(/\[Tipe:\s*[A-Z]+\]/, '').trim();
                    const options = parts[1].trim();
                    const answer = parts[2].trim();
                    
                    tempQuestions.push({
                        type: typeStr,
                        wacana: wacanaHTML,
                        text: parseMarkdown(questionText),
                        options: options.split('~').map(o => parseMarkdown(o.trim())),
                        correctKey: answer
                    });
                });
            }
        });

        // Potong sesuai TARGET_TOTAL_SOAL (Mixer Soal)
        return tempQuestions.slice(0, TARGET_TOTAL_SOAL);
    }

    // ==========================================
    // 3. LOGIKA UI & INTERAKSI
    // ==========================================
    function initApp() {
        document.getElementById('display-judul-login').innerText = JUDUL_KUIS;
        document.getElementById('display-judul-quiz').innerText = JUDUL_KUIS;
        
        // Setup Result Page Links & Texts
        document.getElementById('link-premium').href = LINK_PEMBELIAN_PREMIUM;
        
        document.getElementById('buku1-judul').innerText = BUKU_1_JUDUL;
        document.getElementById('buku1-desc').innerText = BUKU_1_DESC;
        document.getElementById('buku1-link').href = BUKU_1_LINK;
        
        document.getElementById('buku2-judul').innerText = BUKU_2_JUDUL;
        document.getElementById('buku2-desc').innerText = BUKU_2_DESC;
        document.getElementById('buku2-link').href = BUKU_2_LINK;

        questionsData = extractQuestions(RAW_SINGLE, RAW_CLUSTER);
    }

    function togglePassword() {
        const input = document.getElementById('pin-input');
        input.type = input.type === 'password' ? 'text' : 'password';
    }

    function alertPremium(feature) {
        alert(`Buka versi Premium untuk fitur ${feature}!`);
    }

    function startQuiz() {
        const pin = document.getElementById('pin-input').value;
        if(pin !== PIN_AKSES) {
            alert("PIN Akses salah!");
            return;
        }
        
        document.getElementById('login-page').classList.remove('active-page');
        document.getElementById('quiz-page').classList.add('active-page');
        
        renderGrid();
        showQuestion(0);
    }

    function renderGrid() {
        const gridContainer = document.getElementById('cbt-grid');
        gridContainer.innerHTML = '';
        for(let i = 0; i < questionsData.length; i++) {
            const item = document.createElement('div');
            item.className = 'grid-item';
            item.innerText = i + 1;
            gridContainer.appendChild(item);
        }
    }

    function showQuestion(index) {
        if(index < 0 || index >= questionsData.length) return;
        currentIndex = index;
        const q = questionsData[index];

        // Counter
        document.getElementById('question-counter').innerText = `${index + 1} / ${questionsData.length}`;

        // Wacana
        const wacanaBox = document.getElementById('wacana-container');
        if(q.wacana) {
            wacanaBox.innerHTML = q.wacana;
            wacanaBox.style.display = 'block';
        } else {
            wacanaBox.style.display = 'none';
        }

        // Teks Soal
        document.getElementById('question-text').innerHTML = q.text;

        // Opsi (Safe Separator & UI BS)
        const optContainer = document.getElementById('options-container');
        optContainer.innerHTML = '';

        const alphabet = ['A', 'B', 'C', 'D', 'E'];
        
        q.options.forEach((optText, i) => {
            const label = document.createElement('label');
            label.className = 'option-label';
            
            const input = document.createElement('input');
            input.name = `soal_${index}`;
            
            // Konfigurasi Tipe Soal
            if(q.type === 'PGK') {
                input.type = 'checkbox';
                input.value = alphabet[i];
                if(userAnswers[index] && userAnswers[index].includes(alphabet[i])) {
                    input.checked = true;
                    label.classList.add('selected');
                }
            } else if (q.type === 'BS') {
                input.type = 'radio';
                input.value = optText; // Simpan teks aslinya
                if(userAnswers[index] === optText) {
                    input.checked = true;
                    label.classList.add('selected');
                }
            } else {
                input.type = 'radio';
                input.value = alphabet[i];
                if(userAnswers[index] === alphabet[i]) {
                    input.checked = true;
                    label.classList.add('selected');
                }
            }

            input.addEventListener('change', (e) => saveAnswer(index, q.type, e.target));

            label.appendChild(input);
            label.innerHTML += q.type === 'BS' ? optText : `<b>${alphabet[i]}.</b>&nbsp;&nbsp;${optText}`;
            optContainer.appendChild(label);
        });

        // Navigasi Button State
        document.getElementById('btn-prev').style.visibility = index === 0 ? 'hidden' : 'visible';
        
        const btnNext = document.getElementById('btn-next');
        if(index === questionsData.length - 1) {
            btnNext.innerText = 'Selesai';
            btnNext.onclick = finishQuiz;
        } else {
            btnNext.innerText = 'Selanjutnya';
            btnNext.onclick = () => navQuestion(1);
        }
    }

    function saveAnswer(index, type, target) {
        if(type === 'PGK') {
            if(!userAnswers[index]) userAnswers[index] = [];
            if(target.checked) {
                userAnswers[index].push(target.value);
            } else {
                userAnswers[index] = userAnswers[index].filter(v => v !== target.value);
            }
        } else {
            userAnswers[index] = target.value;
        }

        // Update styling
        const labels = document.querySelectorAll('.option-label');
        if(type !== 'PGK') {
            labels.forEach(l => l.classList.remove('selected'));
        }
        if(target.checked) {
            target.parentElement.classList.add('selected');
        } else {
            target.parentElement.classList.remove('selected');
        }
    }

    function navQuestion(dir) {
        showQuestion(currentIndex + dir);
    }

    function finishQuiz() {
        if(!confirm("Anda yakin ingin mengakhiri kuis Trial ini?")) return;
        
        // Hitung Skor Sederhana (Hanya untuk tipe PG biasa demi demo)
        let correctCount = 0;
        questionsData.forEach((q, i) => {
            if(q.type === 'PG' && userAnswers[i] === q.correctKey) {
                correctCount++;
            }
        });
        
        // Estimasi nilai (Skala 100 berdasarkan total soal PG)
        const totalPG = questionsData.filter(q => q.type === 'PG').length || 1;
        const score = Math.round((correctCount / totalPG) * 100);

        document.getElementById('final-score').innerText = score;

        document.getElementById('quiz-page').classList.remove('active-page');
        document.getElementById('result-page').classList.add('active-page');
    }

    // Initialize on load
    window.onload = initApp;
</script>

</body>
</html>
